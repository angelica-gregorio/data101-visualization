<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maternal Health Insights | Pro Dashboard</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Rounded:opsz,wght,FILL,GRAD@24,400,1,0" />
    
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

    <style>
        /* --- DESIGN SYSTEM --- */
        :root {
            /* Palette */
            --primary: #00796B;       /* Deep Teal */
            --primary-light: #B2DFDB;
            --primary-bg: #E0F2F1;
            
            --accent: #FF7043;        /* Soft Coral */
            --accent-bg: #FFCCBC;
            
            --danger: #D32F2F;
            --success: #388E3C;
            
            --surface: #FFFFFF;
            --background: #F4F7FA;
            
            /* Text */
            --text-primary: #1A202C;
            --text-secondary: #718096;
            --text-light: #A0AEC0;
            
            /* Shapes */
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            
            /* Effects */
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.05);
            --shadow-lg: 0 10px 25px rgba(0,0,0,0.08);
            --transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: var(--background);
            color: var(--text-primary);
            margin: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* --- HEADER --- */
        header {
            background: var(--surface);
            height: 70px;
            padding: 0 32px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            z-index: 50;
        }

        .brand-logo {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 700;
            font-size: 1.1rem;
            color: var(--primary);
            letter-spacing: -0.02em;
        }
        .brand-icon {
            background: var(--primary-bg);
            color: var(--primary);
            width: 40px; height: 40px;
            border-radius: var(--radius-sm);
            display: flex; align-items: center; justify-content: center;
        }

        .header-meta {
            display: flex; gap: 24px; font-size: 0.9rem; font-weight: 500; color: var(--text-secondary);
        }
        .header-link { display: flex; align-items: center; gap: 6px; cursor: pointer; transition: var(--transition); }
        .header-link:hover { color: var(--primary); }

        /* --- LAYOUT --- */
        .app-container { display: flex; flex: 1; overflow: hidden; }

        /* --- SIDEBAR --- */
        aside {
            width: 280px;
            background: var(--surface);
            border-right: 1px solid rgba(0,0,0,0.05);
            padding: 24px;
            display: flex;
            flex-direction: column;
            gap: 32px;
            overflow-y: auto;
        }

        .sidebar-group-title {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.08em;
            color: var(--text-light);
            margin-bottom: 16px;
            font-weight: 700;
            display: flex; align-items: center; gap: 8px;
        }

        .control-panel {
            background: var(--background);
            padding: 16px;
            border-radius: var(--radius-md);
            border: 1px solid rgba(0,0,0,0.03);
        }

        /* Modern Range Slider */
        .range-wrapper { margin-top: 10px; }
        .range-header { display: flex; justify-content: space-between; font-size: 0.85rem; margin-bottom: 8px; font-weight: 600; }
        input[type=range] { width: 100%; accent-color: var(--primary); cursor: pointer; }
        .range-labels { display: flex; justify-content: space-between; font-size: 0.7rem; color: var(--text-light); margin-top: 6px; }

        /* Toggle Switch */
        .toggle-row { display: flex; align-items: center; justify-content: space-between; font-size: 0.9rem; font-weight: 500; }
        .switch { position: relative; display: inline-block; width: 44px; height: 24px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #CBD5E0; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 18px; width: 18px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; box-shadow: 0 2px 4px rgba(0,0,0,0.2); }
        input:checked + .slider { background-color: var(--primary); }
        input:checked + .slider:before { transform: translateX(20px); }

        /* Checkboxes */
        .checkbox-item { display: flex; align-items: center; gap: 10px; padding: 8px 0; font-size: 0.9rem; color: var(--text-secondary); cursor: pointer; transition: var(--transition); }
        .checkbox-item:hover { color: var(--primary); }
        input[type="checkbox"] { accent-color: var(--primary); width: 16px; height: 16px; }

        /* --- MAIN CONTENT --- */
        main {
            flex: 1;
            padding: 32px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        /* KPI CARDS */
        .grid-kpi { display: grid; grid-template-columns: repeat(4, 1fr); gap: 24px; }
        
        .card-kpi {
            background: var(--surface);
            padding: 24px;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
            border: 1px solid rgba(0,0,0,0.03);
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            transition: var(--transition);
        }
        .card-kpi:hover { transform: translateY(-4px); box-shadow: var(--shadow-md); }

        .kpi-header { display: flex; align-items: flex-start; justify-content: space-between; margin-bottom: 12px; }
        .kpi-icon { 
            width: 40px; height: 40px; border-radius: 50%; 
            display: flex; align-items: center; justify-content: center;
        }
        .kpi-label { font-size: 0.85rem; color: var(--text-secondary); font-weight: 600; }
        
        .kpi-value { font-size: 1.75rem; font-weight: 700; color: var(--text-primary); letter-spacing: -0.02em; }
        .kpi-sub { font-size: 0.8rem; margin-top: 8px; display: flex; align-items: center; gap: 4px; }

        /* Status Colors */
        .bg-teal { background: var(--primary-bg); color: var(--primary); }
        .bg-orange { background: var(--accent-bg); color: var(--accent); }
        .text-up { color: var(--danger); }
        .text-down { color: var(--success); }

        /* --- VISUALIZATION SECTIONS --- */
        .section-split { display: flex; gap: 24px; min-height: 420px; }
        .section-charts { display: flex; gap: 24px; min-height: 320px; }

        .card-viz {
            background: var(--surface);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-sm);
            border: 1px solid rgba(0,0,0,0.03);
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        .map-wrapper { flex: 2; padding: 0; position: relative; }
        .details-wrapper { flex: 1; padding: 24px; }

        /* Details Panel */
        .panel-header { margin-bottom: 20px; padding-bottom: 16px; border-bottom: 1px solid var(--background); }
        .panel-title { font-size: 0.8rem; text-transform: uppercase; color: var(--text-light); font-weight: 700; margin-bottom: 4px; }
        .panel-data { font-size: 1.25rem; font-weight: 700; color: var(--text-primary); }

        .insight-block {
            background: #F0F9FF;
            border-left: 4px solid #0EA5E9;
            padding: 16px;
            border-radius: 0 var(--radius-sm) var(--radius-sm) 0;
            font-size: 0.9rem;
            line-height: 1.6;
            color: #0c4a6e;
            margin-bottom: 24px;
        }
        
        .btn-outline {
            width: 100%; padding: 12px;
            border: 1px solid var(--border);
            border-radius: var(--radius-md);
            background: transparent;
            color: var(--text-primary);
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex; align-items: center; justify-content: center; gap: 8px;
        }
        .btn-outline:hover { background: var(--background); border-color: var(--text-secondary); }

        /* Charts */
        .chart-header { padding: 20px 24px 0 24px; margin-bottom: 16px; }
        .chart-title { font-size: 1rem; font-weight: 700; color: var(--text-primary); display: flex; align-items: center; gap: 8px; }
        .chart-body { flex: 1; padding: 0 24px 20px 24px; position: relative; }

    </style>
</head>
<body>

    <header>
        <div class="brand-logo">
            <div class="brand-icon">
                <span class="material-symbols-rounded">cardiology</span>
            </div>
            <span>Maternal Health Insights<br><small style="font-weight:400; color:var(--text-light); font-size:0.8rem;">NDHS 2022 Analytics</small></span>
        </div>
        <div class="header-meta">
            <div class="header-link"><span class="material-symbols-rounded">description</span> Documentation</div>
            <div class="header-link"><span class="material-symbols-rounded">download</span> Export Data</div>
            <div class="header-link"><div style="width:32px; height:32px; background:var(--text-light); border-radius:50%; color:white; display:flex; align-items:center; justify-content:center; font-size:0.8rem;">G4</div></div>
        </div>
    </header>

    <div class="app-container">
        
        <aside>
            <div>
                <div class="sidebar-group-title">
                    <span class="material-symbols-rounded" style="font-size:16px;">timelapse</span> Time Series Animation
                </div>
                <div class="control-panel">
                    <div class="range-header">
                        <span>Age Cohort</span>
                        <span id="ageLabel" style="color:var(--primary);">All Ages</span>
                    </div>
                    <div class="range-wrapper">
                        <input type="range" id="ageSlider" min="0" max="3" value="0" step="1">
                        <div class="range-labels">
                            <span>15-19</span><span>20s</span><span>30s</span><span>40+</span>
                        </div>
                    </div>
                </div>
            </div>

            <div>
                <div class="sidebar-group-title">
                    <span class="material-symbols-rounded" style="font-size:16px;">experiment</span> Scenarios
                </div>
                <div class="control-panel toggle-row">
                    <div>
                        <div style="color:var(--text-primary);">Policy Simulator</div>
                        <div style="font-size:0.75rem; color:var(--text-secondary);">Secondary Edu+ Mandate</div>
                    </div>
                    <label class="switch">
                        <input type="checkbox" id="policyToggle">
                        <span class="slider"></span>
                    </label>
                </div>
            </div>

            <div>
                <div class="sidebar-group-title">
                    <span class="material-symbols-rounded" style="font-size:16px;">filter_list</span> Segmentation
                </div>
                <div class="checkbox-item"><input type="checkbox" checked> <span>Poorest Quintile (Q1)</span></div>
                <div class="checkbox-item"><input type="checkbox" checked> <span>Middle Quintile (Q3)</span></div>
                <div class="checkbox-item"><input type="checkbox" checked> <span>Richest Quintile (Q5)</span></div>
            </div>
        </aside>

        <main>
            
            <div class="grid-kpi">
                <div class="card-kpi">
                    <div class="kpi-header">
                        <span class="kpi-label">Total Respondents</span>
                        <div class="kpi-icon bg-teal"><span class="material-symbols-rounded">groups</span></div>
                    </div>
                    <div>
                        <div class="kpi-value">15,400</div>
                        <div class="kpi-sub text-down"><span class="material-symbols-rounded" style="font-size:16px;">arrow_upward</span> 2.4% vs 2017</div>
                    </div>
                </div>
                
                <div class="card-kpi">
                    <div class="kpi-header">
                        <span class="kpi-label">Avg Age 1st Birth</span>
                        <div class="kpi-icon bg-teal"><span class="material-symbols-rounded">face_3</span></div>
                    </div>
                    <div>
                        <div class="kpi-value" id="kpiAge">21.4 <span style="font-size:1rem; color:var(--text-light);">yrs</span></div>
                        <div class="kpi-sub" style="color:var(--text-light);">National Average</div>
                    </div>
                </div>

                <div class="card-kpi">
                    <div class="kpi-header">
                        <span class="kpi-label">Pregnancy Rate</span>
                        <div class="kpi-icon bg-teal"><span class="material-symbols-rounded">child_care</span></div>
                    </div>
                    <div>
                        <div class="kpi-value">4.2%</div>
                        <div class="kpi-sub" style="color:var(--text-light);">Point Prevalence</div>
                    </div>
                </div>

                <div class="card-kpi" style="border-color: var(--accent-bg);">
                    <div class="kpi-header">
                        <span class="kpi-label" style="color:var(--accent);">Teen Pregnancies</span>
                        <div class="kpi-icon bg-orange"><span class="material-symbols-rounded">warning</span></div>
                    </div>
                    <div>
                        <div class="kpi-value" style="color:var(--accent);" id="kpiTeen">12.5%</div>
                        <div class="kpi-sub text-up"><span class="material-symbols-rounded" style="font-size:16px;">trending_up</span> Critical Level</div>
                    </div>
                </div>
            </div>

            <div class="section-split">
                <div class="card-viz map-wrapper">
                    <div id="map" style="width: 100%; height: 100%;"></div>
                    <div style="position:absolute; bottom:20px; right:20px; background:white; padding:12px; border-radius:8px; box-shadow:0 4px 12px rgba(0,0,0,0.1); font-size:0.75rem; z-index:999;">
                        <strong>Risk Level</strong><br>
                        <span style="color:var(--primary);">●</span> Low Risk<br>
                        <span style="color:var(--accent);">●</span> High Risk
                    </div>
                </div>
                
                <div class="card-viz details-wrapper">
                    <div class="panel-header">
                        <div class="panel-title">Selected Region</div>
                        <div class="panel-data" id="regionLabel">National View</div>
                    </div>
                    
                    <div class="insight-block" id="insightBox">
                        <strong><span class="material-symbols-rounded" style="font-size: 18px; vertical-align: middle;">lightbulb</span> Key Insight:</strong><br>
                        Wealthier regions (NCR, Calabarzon) consistently show a <strong>3-year delay</strong> in first birth age compared to rural averages.
                    </div>

                    <div style="margin-top:auto;">
                        <button class="btn-outline">
                            <span class="material-symbols-rounded">picture_as_pdf</span> Generate Regional PDF
                        </button>
                    </div>
                </div>
            </div>

            <div class="section-charts">
                <div class="card-viz">
                    <div class="chart-header">
                        <div class="chart-title">
                            <span class="material-symbols-rounded" style="color:var(--primary);">bar_chart</span>
                            Education Impact
                        </div>
                    </div>
                    <div class="chart-body"><canvas id="barChart"></canvas></div>
                </div>
                
                <div class="card-viz">
                    <div class="chart-header">
                        <div class="chart-title">
                            <span class="material-symbols-rounded" style="color:var(--primary);">show_chart</span>
                            Wealth Distribution
                        </div>
                    </div>
                    <div class="chart-body"><canvas id="lineChart"></canvas></div>
                </div>
            </div>

        </main>
    </div>

    <script>
        // --- CONFIG ---
        Chart.defaults.font.family = "'Plus Jakarta Sans', sans-serif";
        Chart.defaults.color = '#A0AEC0';
        Chart.defaults.borderColor = 'rgba(0,0,0,0.05)';

        // --- 1. MAP SETUP ---
        var map = L.map('map', {zoomControl: false}).setView([12.8797, 121.7740], 6);
        L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; OpenStreetMap &copy; CARTO'
        }).addTo(map);

        // Map Markers (Linked View)
        var regions = [
            { name: "NCR (Metro Manila)", coords: [14.5995, 120.9842], age: 24.5, teen: "5.2%", color: "#00796B" },
            { name: "Davao Region", coords: [7.1907, 125.4553], age: 20.1, teen: "15.8%", color: "#FF7043" },
            { name: "Cebu (Visayas)", coords: [10.3157, 123.8854], age: 22.3, teen: "9.4%", color: "#00796B" }
        ];

        regions.forEach(reg => {
            var marker = L.circleMarker(reg.coords, {
                radius: 12, fillColor: reg.color, color: 'white', weight: 2, fillOpacity: 0.9
            }).addTo(map);

            marker.on('click', () => {
                // Update Context
                document.getElementById('regionLabel').innerText = reg.name;
                document.getElementById('insightBox').innerHTML = 
                    `<strong><span class="material-symbols-rounded" style="font-size: 18px; vertical-align: middle;">location_on</span> Regional Data:</strong><br>${reg.name} has an Avg Age of 1st Birth of <strong>${reg.age}</strong> and a Teenage Pregnancy rate of <strong>${reg.teen}</strong>.`;
                
                // Update KPIs
                document.getElementById('kpiAge').innerText = reg.age;
                document.getElementById('kpiTeen').innerText = reg.teen;
            });
        });

        // --- 2. CHARTS ---
        // Bar Chart (Animated via Slider)
        const ageCohorts = [
            { label: "15-19 (Teens)", data: [18.5, 17.2, 0, 0] },
            { label: "20-29 (Young Adult)", data: [19.2, 21.5, 23.8, 25.1] },
            { label: "30-39 (Adult)", data: [20.5, 22.8, 25.5, 28.2] },
            { label: "40+ (Mature)", data: [21.0, 23.5, 26.0, 29.5] }
        ];

        var ctxBar = document.getElementById('barChart').getContext('2d');
        var barChart = new Chart(ctxBar, {
            type: 'bar',
            data: {
                labels: ['No Edu', 'Primary', 'Secondary', 'Higher'],
                datasets: [{
                    label: 'Avg Age',
                    data: ageCohorts[0].data,
                    backgroundColor: ['#FF7043', '#FFAB91', '#80CBC4', '#00796B'],
                    borderRadius: 6,
                    barThickness: 40
                }]
            },
            options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
        });

        // Line Chart (Static)
        new Chart(document.getElementById('lineChart'), {
            type: 'line',
            data: {
                labels: ['Q1', 'Q2', 'Q3', 'Q4', 'Q5'],
                datasets: [{
                    label: 'Pregnancy Rate %',
                    data: [8.5, 6.2, 4.1, 3.0, 1.5],
                    borderColor: '#00796B',
                    backgroundColor: 'rgba(0, 121, 107, 0.1)',
                    fill: true, tension: 0.4
                }]
            },
            options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
        });

        // --- 3. CONTROLS ---
        
        // Slider Animation
        document.getElementById('ageSlider').addEventListener('input', function(e) {
            const index = e.target.value;
            document.getElementById('ageLabel').innerText = ageCohorts[index].label;
            barChart.data.datasets[0].data = ageCohorts[index].data;
            barChart.update();
        });

        // Policy Simulation Callback
        document.getElementById('policyToggle').addEventListener('change', function(e) {
            const isActive = e.target.checked;
            const kpiAge = document.getElementById('kpiAge');
            const kpiTeen = document.getElementById('kpiTeen');
            const insightBox = document.getElementById('insightBox');

            if(isActive) {
                kpiAge.innerHTML = "23.8 <span style='font-size:1rem; color:#388E3C;'>(+2.4)</span>";
                kpiTeen.innerHTML = "8.1%";
                kpiTeen.style.color = "var(--success)";
                insightBox.style.borderLeftColor = "var(--success)";
                insightBox.innerHTML = "<strong><span class=\"material-symbols-rounded\" style=\"font-size: 18px; vertical-align: middle; color: var(--success);\">check_circle</span> Simulation Active:</strong><br>Mandatory secondary education is projected to reduce teenage pregnancies by <strong>35%</strong>.";
                barChart.data.datasets[0].backgroundColor = Array(4).fill('#388E3C');
                barChart.update();
            } else {
                kpiAge.innerHTML = "21.4 <span style='font-size:1rem; color:var(--text-light);'>yrs</span>";
                kpiTeen.innerHTML = "12.5%";
                kpiTeen.style.color = "var(--accent)";
                insightBox.style.borderLeftColor = "#0EA5E9";
                insightBox.innerHTML = "<strong><span class=\"material-symbols-rounded\" style=\"font-size: 18px; vertical-align: middle;\">lightbulb</span> Key Insight:</strong><br>Wealthier regions (NCR, Calabarzon) consistently show a <strong>3-year delay</strong> in first birth age.";
                barChart.data.datasets[0].backgroundColor = ['#FF7043', '#FFAB91', '#80CBC4', '#00796B'];
                barChart.update();
            }
        });

    </script>
</body>
</html>
